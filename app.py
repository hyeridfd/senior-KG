import streamlit as st
from dotenv import load_dotenv
# ê¸°ì¡´ì— ì‘ì„±í•œ kg_enhanced_obesity_rag í•¨ìˆ˜ê°€ í¬í•¨ëœ íŒŒì¼ì„ import í•˜ê±°ë‚˜ ì•„ë˜ì— ì •ì˜í•˜ì„¸ìš”.

# 1. í˜ì´ì§€ ì„¤ì •
st.set_page_config(page_title="ë…¸ì¸ ë¹„ë§Œ ë§ì¶¤í˜• ì˜ì–‘ ê´€ë¦¬ AI", page_icon="ğŸ¥—", layout="wide")

# 2. ìŠ¤íƒ€ì¼ ë° ì œëª©
st.title("ğŸ¥— ë…¸ì¸ ë¹„ë§Œ ë§ì¶¤í˜• ì˜ì–‘ ê´€ë¦¬ AI ë¹„ì„œ")
st.markdown("""
ì´ ì‹œìŠ¤í…œì€ **'ë¹„ë§Œ ì§„ë£Œì§€ì¹¨ 2022'**ì™€ **ìˆ˜ì‚°ë¬¼(Blue Food) ë ˆì‹œí”¼ DB**ë¥¼ ê²°í•©í•˜ì—¬ 
ì–´ë¥´ì‹ ë“¤ì—ê²Œ ê°€ì¥ ì í•©í•œ ì˜í•™ì  ê·¼ê±° ê¸°ë°˜ ì‹ë‹¨ì„ ì œì•ˆí•©ë‹ˆë‹¤.
---
""")

# 3. ì‚¬ì´ë“œë°” (DB ì—°ê²° ìƒíƒœ í™•ì¸ìš©)
with st.sidebar:
    st.header("âš™ï¸ ì‹œìŠ¤í…œ ìƒíƒœ")
    # ì‹¤ì œ ì—°ê²° í™•ì¸ ë¡œì§ì„ ë„£ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
    st.success("âœ… Disease DB ì—°ê²°ë¨ (7689)")
    st.success("âœ… FoodGraph DB ì—°ê²°ë¨ (7687)")
    st.info("ì—°êµ¬ì›: ë¥˜í˜œë¦¬ (ì„¸ê³„í‘¸ë“œí…Œí¬ì°½ì˜ì„¼í„°)")

# 4. ì‚¬ìš©ì ì…ë ¥ ì„¹ì…˜
question = st.text_input("ì§ˆë¬¸ì„ ì…ë ¥í•˜ì„¸ìš”:", placeholder="ì˜ˆ: ê·¼ê°ì†Œì¦ì´ ìˆëŠ” ë¹„ë§Œ ì–´ë¥´ì‹ ì„ ìœ„í•œ ê³ ë‹¨ë°± ì‹ë‹¨ì„ ì¶”ì²œí•´ ì¤˜.")

if st.button("ì‹ë‹¨ ë¶„ì„ ì‹œì‘"):
    if question:
        with st.spinner('ì§€ì¹¨ê³¼ ë ˆì‹œí”¼ DBë¥¼ ë¶„ì„ ì¤‘ì…ë‹ˆë‹¤...'):
            try:
                # í˜œë¦¬ ë‹˜ì´ ë§Œë“  RAG í•¨ìˆ˜ í˜¸ì¶œ
                # response = kg_enhanced_obesity_rag(question) 
                
                # ê°€ìƒì˜ ê²°ê³¼ ì˜ˆì‹œ (ì‹¤ì œ ì‹¤í–‰ ì‹œ ìœ„ í•¨ìˆ˜ ê²°ê³¼ ì‚¬ìš©)
                # answer = response 
                
                # 5. ê²°ê³¼ ë ˆì´ì•„ì›ƒ êµ¬ì„±
                col1, col2 = st.columns(2)

                with col1:
                    st.subheader("ğŸ“‹ ì˜í•™ì  ì§€ì¹¨ ê·¼ê±°")
                    # ì˜ˆ: st.write(answer_split_by_guideline)
                    st.info("ë¹„ë§Œ ì§„ë£Œì§€ì¹¨ 2022ì— ì˜ê±°í•˜ì—¬ ë‹¨ë°±ì§ˆ ì„­ì·¨ì™€ ì—´ëŸ‰ ì œí•œì„ ê¶Œê³ í•©ë‹ˆë‹¤.")

                with col2:
                    st.subheader("ğŸ½ï¸ ë§ì¶¤í˜• ì¶”ì²œ ë©”ë‰´")
                    # ì˜ˆ: st.success(answer_split_by_recipe)
                    st.success("ì¶”ì²œ ë©”ë‰´: ì „ë³µ ë‘ë¶€ ìŠ¤í…Œì´í¬ (ë‹¨ë°±ì§ˆ 25g í•¨ìœ )")

                st.divider()
                st.markdown("### ğŸ¤– ì¢…í•© ê°€ì´ë“œë¼ì¸")
                st.write("ìœ„ ë©”ë‰´ëŠ” ì§€ì¹¨ì—ì„œ ê°•ì¡°í•˜ëŠ” ë…¸ì¸ ë¹„ë§Œ ê´€ë¦¬ ìˆ˜ì¹™ì„ ì¶©ì¡±í•©ë‹ˆë‹¤.")

            except Exception as e:
                st.error(f"ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: {e}")
    else:
        st.warning("ì§ˆë¬¸ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.")
